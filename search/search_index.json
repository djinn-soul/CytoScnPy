{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"CytoScnPy","text":"<p>High-Performance Python Static Analysis Tool Powered by Rust</p> <p> </p> <p>CytoScnPy is a blazing fast static analysis tool for Python codebases. It uses a hybrid Rust/Python architecture to detect dead code, security vulnerabilities, and code quality issues with extreme speed and minimal memory footprint.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>\ud83d\ude80 Blazing Fast: Written in Rust for maximum performance.</li> <li>\ud83d\udc80 Dead Code Detection: Finds unused functions, classes, methods, imports, and variables.</li> <li>\ud83d\udd12 Security Scanning: Detects secrets (API keys), dangerous patterns (eval/exec), and taint analysis.</li> <li>\ud83d\udcca Code Quality: Calculates Cyclomatic Complexity, Halstead metrics, and Maintainability Index.</li> <li>\ud83e\udde9 Deep Integration: VS Code extension and MCP server for AI assistants.</li> <li>\ud83d\udee0\ufe0f Framework Aware: Native support for Flask, Django, FastAPI, and Pydantic.</li> </ul>"},{"location":"#deep-integration","title":"Deep Integration","text":"<ul> <li>Hybrid Architecture: High-performance Rust core (<code>cytoscnpy</code>) with Python bindings (<code>PyO3</code>).</li> <li>Taint Analysis: Tracks data flow from untrusted sources to dangerous sinks (SQL, Shell, Code Execution).</li> <li>Clone Detection: Uses Weisfeiler-Lehman graph hashing for semantic similarity.</li> </ul>"},{"location":"#installation","title":"Installation","text":"<p>Linux / macOS:</p> <pre><code># Install\ncurl -fsSL https://raw.githubusercontent.com/djinn09/CytoScnPy/main/install.sh | bash\n</code></pre> <p>Windows (PowerShell):</p> <pre><code># Install\nirm https://raw.githubusercontent.com/djinn09/CytoScnPy/main/install.ps1 | iex\n</code></pre> <p>Via Pip:</p> <pre><code>pip install cytoscnpy\n</code></pre> <p>From Source:</p> <pre><code>git clone https://github.com/djinn09/CytoScnPy.git\ncd CytoScnPy\nmaturin develop -m cytoscnpy/Cargo.toml\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"<p>Analyze your current directory for everything (dead code, security, quality):</p> <pre><code>cytoscnpy . --secrets --danger --quality\n</code></pre> <p>Generate a JSON report for CI/CD:</p> <pre><code>cytoscnpy . --json &gt; report.json\n</code></pre> <p>Preview and fix dead code automatically:</p> <pre><code>cytoscnpy . --fix        # Preview changes (dry run)\ncytoscnpy . --fix --apply # Apply changes\n</code></pre>"},{"location":"#links","title":"Links","text":"<ul> <li>Documentation: djinn09.github.io/CytoScnPy</li> <li>PyPI: pypi.org/project/cytoscnpy</li> <li>VS Code Extension: Visual Studio Marketplace</li> <li>GitHub Repository: github.com/djinn09/CytoScnPy</li> </ul>"},{"location":"CLI/","title":"CLI Reference","text":"<p>This document provides a comprehensive reference for the <code>cytoscnpy</code> command-line interface.</p>"},{"location":"CLI/#command-syntax","title":"Command Syntax","text":"<pre><code>cytoscnpy [OPTIONS] [COMMAND]\n</code></pre>"},{"location":"CLI/#main-options","title":"Main Options","text":""},{"location":"CLI/#input-output","title":"Input &amp; Output","text":"<ul> <li><code>[paths]</code>: One or more paths to analyze (files or directories). If omitted, CytoScnPy defaults to the current working directory.</li> <li><code>--root &lt;PATH&gt;</code>: Explicitly sets the project root. This is highly recommended for CI/CD environments to ensure that path-based security containment is correctly applied and that relative imports are resolved consistently. When <code>--root</code> is used, positional <code>[paths]</code> are not allowed.</li> <li><code>--exclude-folder &lt;FOLDER&gt;</code>: Specifies a folder name to skip during analysis (e.g., <code>venv</code>, <code>node_modules</code>). This flag can be provided multiple times to exclude multiple directories.</li> <li><code>--include-folder &lt;FOLDER&gt;</code>: Force-includes a folder that might otherwise be ignored by default rules (like some hidden directories).</li> <li><code>--json</code>: Format the result as a raw JSON object. This is ideal for piping into tools like <code>jq</code> or for consumption by CI/CD scripts.</li> <li><code>--verbose</code>, <code>-v</code>: Prints detailed logs during the analysis process, including which files are being scanned and any non-fatal issues encountered.</li> <li><code>--quiet</code>: Minimalist output. Only the final summary table (or JSON) is displayed, suppressing the per-file findings table.</li> <li><code>--fail-on-quality</code>: Causes the process to exit with code <code>1</code> if any code quality issues (like high complexity or deep nesting) are detected.</li> <li><code>--html</code>: Generates a self-contained, interactive HTML report. Note that this feature may require additional dependencies and automatically enables quality scanning.</li> </ul>"},{"location":"CLI/#scan-types","title":"Scan Types","text":"<ul> <li><code>--secrets</code>, <code>-s</code>: Actively scans for high-entropy strings, API keys, and hardcoded credentials. It checks variables, strings, and even comments (depending on configuration).</li> <li><code>--danger</code>, <code>-d</code>: Enables security scanning for dangerous patterns like <code>eval()</code>, <code>exec()</code>, and insecure temporary file creation. It also activates taint analysis to track user-controlled data flowing into dangerous sinks (e.g., SQL injection or command injection points). See Dangerous Code for a full rule list.</li> <li><code>--quality</code>, <code>-q</code>: Runs code quality checks including Cyclomatic Complexity, Maintainability Index, block nesting depth, and function length/argument counts.</li> <li><code>--no-dead</code>, <code>-n</code>: Skips the default dead code detection. Use this if you only care about security vulnerabilities or quality metrics and want to speed up the analysis.</li> </ul>"},{"location":"CLI/#analysis-configuration","title":"Analysis Configuration","text":"<ul> <li><code>--confidence &lt;N&gt;</code>: Sets a minimum confidence threshold (0-100). CytoScnPy uses a scoring system for dead code; setting this to <code>80</code>, for example, will suppress \"noisy\" findings where the tool isn't certain the code is unused.</li> <li><code>--include-tests</code>: By default, CytoScnPy ignores files in folders like <code>tests/</code> or <code>test/</code> starting from version 1.2.2. Use this flag to include them in the analysis.</li> <li><code>--include-ipynb</code>: Enables scanning of Jupyter Notebook files. CytoScnPy extracts the Python code from cells and analyzes it as a virtual module.</li> <li><code>--ipynb-cells</code>: When combined with <code>--include-ipynb</code>, this reports findings with cell numbers instead of just line numbers, making it easier to locate issues in the Notebook UI.</li> <li><code>--clones</code>: Activates duplicate code detection. It uses AST-based hashing to find code blocks that are identical or nearly identical across your codebase.</li> <li><code>--clone-similarity &lt;N&gt;</code>: Sets the similarity threshold for clone detection (0.0 to 1.0). A value of <code>1.0</code> finds only exact duplicates; a lower value like <code>0.8</code> (default) finds similar logic that might be refactored.</li> <li><code>--fix</code>: Enables \"Dead Code Auto-Fix\" mode. By default, this is a dry-run\u2014it will show you exactly what code would be removed without touching your files.</li> <li><code>--apply</code>, <code>-a</code>: Executes the changes suggested by <code>--fix</code>. Warning: This modifies your source code. It is highly recommended to run with <code>--fix</code> first to review changes, and to have a clean Git state before applying.</li> </ul>"},{"location":"CLI/#quality-thresholds-gate-overrides","title":"Quality Thresholds (Gate Overrides)","text":"<p>These flags allow you to set strict \"gates\" for your code. If any part of the codebase exceeds these numbers, CytoScnPy will exit with code <code>1</code>.</p> <ul> <li><code>--fail-threshold &lt;N&gt;</code>: Exit with 1 if the total percentage of unused code exceeds <code>N</code>.</li> <li><code>--max-complexity &lt;N&gt;</code>: Sets the maximum allowed Cyclomatic Complexity (standard is often <code>10</code>).</li> <li><code>--min-mi &lt;N&gt;</code>: Sets the minimum allowed Maintainability Index (usually <code>40-65</code>).</li> <li><code>--max-nesting &lt;N&gt;</code>: Sets the maximum allowed indentation/nesting level (e.g., <code>3</code> or <code>4</code>).</li> <li><code>--max-args &lt;N&gt;</code>: Sets the maximum number of arguments a function can have.</li> <li><code>--max-lines &lt;N&gt;</code>: Sets the maximum number of lines a function can have.</li> </ul>"},{"location":"CLI/#subcommands","title":"Subcommands","text":""},{"location":"CLI/#raw","title":"<code>raw</code>","text":"<p>Calculate raw metrics (LOC, LLOC, SLOC, Comments, Multi, Blank).</p> <pre><code>cytoscnpy raw [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-j</code>, <code>--json</code>: Output JSON.</li> <li><code>-s</code>, <code>--summary</code>: Show summary metrics.</li> <li><code>-O</code>, <code>--output-file &lt;FILE&gt;</code>: Save output to file.</li> <li><code>-e</code>, <code>--exclude &lt;DIR&gt;</code>: Folders to exclude.</li> <li><code>-i</code>, <code>--ignore &lt;PATTERN&gt;</code>: Glob patterns to ignore.</li> </ul>"},{"location":"CLI/#cc","title":"<code>cc</code>","text":"<p>Calculate Cyclomatic Complexity.</p> <pre><code>cytoscnpy cc [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-a</code>, <code>--average</code>: Show average complexity.</li> <li><code>--total-average</code>: Show total average complexity.</li> <li><code>-s</code>, <code>--show-complexity</code>: Show complexity score with rank.</li> <li><code>-n</code>, <code>--min &lt;RANK&gt;</code>: Set minimum complexity rank (A-F).</li> <li><code>-x</code>, <code>--max &lt;RANK&gt;</code>: Set maximum complexity rank (A-F).</li> <li><code>-o</code>, <code>--order &lt;ORDER&gt;</code>: Ordering function (score, lines, alpha).</li> <li><code>--no-assert</code>: Do not count assert statements.</li> <li><code>--xml</code>: Output XML.</li> <li><code>--fail-threshold &lt;N&gt;</code>: Exit 1 if any block has complexity &gt; N.</li> <li><code>-j</code>, <code>--json</code>: Output JSON.</li> <li><code>-e</code>, <code>--exclude &lt;DIR&gt;</code>: Folders to exclude.</li> <li><code>-i</code>, <code>--ignore &lt;PATTERN&gt;</code>: Glob patterns to ignore.</li> <li><code>-O</code>, <code>--output-file &lt;FILE&gt;</code>: Save output to file.</li> </ul>"},{"location":"CLI/#hal","title":"<code>hal</code>","text":"<p>Calculate Halstead Metrics.</p> <pre><code>cytoscnpy hal [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-f</code>, <code>--functions</code>: Compute metrics on function level.</li> <li><code>-j</code>, <code>--json</code>: Output JSON.</li> <li><code>-e</code>, <code>--exclude &lt;DIR&gt;</code>: Folders to exclude.</li> <li><code>-i</code>, <code>--ignore &lt;PATTERN&gt;</code>: Glob patterns to ignore.</li> <li><code>-O</code>, <code>--output-file &lt;FILE&gt;</code>: Save output to file.</li> </ul>"},{"location":"CLI/#mi","title":"<code>mi</code>","text":"<p>Calculate Maintainability Index.</p> <pre><code>cytoscnpy mi [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-s</code>, <code>--show</code>: Show actual MI value.</li> <li><code>-a</code>, <code>--average</code>: Show average MI.</li> <li><code>-n</code>, <code>--min &lt;RANK&gt;</code>: Set minimum MI rank (A-C).</li> <li><code>-x</code>, <code>--max &lt;RANK&gt;</code>: Set maximum MI rank (A-C).</li> <li><code>--multi</code>: Count multiline strings as comments (default: true).</li> <li><code>--fail-threshold &lt;N&gt;</code>: Exit 1 if any file has MI &lt; N.</li> <li><code>-j</code>, <code>--json</code>: Output JSON.</li> <li><code>-e</code>, <code>--exclude &lt;DIR&gt;</code>: Folders to exclude.</li> <li><code>-i</code>, <code>--ignore &lt;PATTERN&gt;</code>: Glob patterns to ignore.</li> <li><code>-O</code>, <code>--output-file &lt;FILE&gt;</code>: Save output to file.</li> </ul>"},{"location":"CLI/#stats","title":"<code>stats</code>","text":"<p>Generate comprehensive project statistics report.</p> <pre><code>cytoscnpy stats [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-a</code>, <code>--all</code>: Enable all analysis: secrets, danger, quality, files.</li> <li><code>--root &lt;PATH&gt;</code>: Project root for analysis (use instead of positional path).</li> <li><code>-s</code>, <code>--secrets</code>: Scan for secrets.</li> <li><code>-d</code>, <code>--danger</code>: Scan for dangerous code.</li> <li><code>-q</code>, <code>--quality</code>: Scan for quality issues.</li> <li><code>-j</code>, <code>--json</code>: Output JSON.</li> <li><code>-o</code>, <code>--output &lt;FILE&gt;</code>: Output file path.</li> <li><code>--exclude-folder &lt;DIR&gt;</code>: Exclude specific folders from analysis.</li> </ul>"},{"location":"CLI/#files","title":"<code>files</code>","text":"<p>Show per-file metrics table.</p> <pre><code>cytoscnpy files [OPTIONS] &lt;PATH&gt;\n</code></pre> <ul> <li><code>-j</code>, <code>--json</code>: Output only JSON.</li> <li><code>--exclude-folder &lt;DIR&gt;</code>: Exclude specific folders from analysis.</li> </ul>"},{"location":"CLI/#mcp-server","title":"<code>mcp-server</code>","text":"<p>Start MCP server for LLM integration.</p> <pre><code>cytoscnpy mcp-server\n</code></pre>"},{"location":"CLI/#configuration-file","title":"Configuration File","text":"<p>Create <code>.cytoscnpy.toml</code> in your project root to set defaults.</p> <pre><code>[cytoscnpy]\n# Core settings\nconfidence = 60\nsecrets = true\ndanger = true\nquality = true\ninclude_tests = false\ninclude_ipynb = false\n# Note: ipynb_cells is currently a CLI-only option\n\n# Quality thresholds\nmax_complexity = 10        # Max cyclomatic complexity\nmax_nesting = 3            # Max nesting depth\nmax_args = 5               # Max function arguments\nmax_lines = 50             # Max function lines\nmin_mi = 40.0              # Min Maintainability Index\n\n# Path filters\nexclude_folders = [\"build\", \"dist\", \".venv\"]\ninclude_folders = [\"src\"]\n\n# CI/CD\nfail_threshold = 5.0\n</code></pre>"},{"location":"CLI/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code>: Success, no issues found (or issues below threshold).</li> <li><code>1</code>: Issues found exceeding thresholds (quality, security, or fail_threshold).</li> <li><code>2</code>: Runtime error or invalid arguments.</li> </ul>"},{"location":"CLI/#see-also","title":"See Also","text":"<ul> <li>Usage Guide</li> </ul>"},{"location":"contributing/","title":"Contributing to CytoScnPy","text":"<p>Thank you for your interest in contributing to CytoScnPy!</p>"},{"location":"contributing/#prerequisites","title":"\ud83d\udee0\ufe0f Prerequisites","text":"<ul> <li>Rust: Version 1.70 or higher.</li> <li>Cargo: Comes with Rust.</li> <li>Python: Version 3.8 or higher.</li> <li>Maturin: <code>pip install maturin</code></li> </ul>"},{"location":"contributing/#setup-development-environment","title":"\ud83d\ude80 Setup Development Environment","text":"<ol> <li>Fork and Clone:</li> </ol> <pre><code>git clone https://github.com/YOUR_USERNAME/cytoscnpy.git\ncd cytoscnpy\n</code></pre> <ol> <li>Create Virtual Environment:</li> </ol> <pre><code>python -m venv .venv\nsource .venv/bin/activate  # Linux/macOS\n.venv\\Scripts\\activate     # Windows\n</code></pre> <ol> <li>Install Dependencies &amp; Build:</li> </ol> <pre><code>pip install maturin\nmaturin develop -m cytoscnpy/Cargo.toml\n</code></pre> <ol> <li>Run Tests:</li> </ol> <pre><code>cargo test\npytest python/tests\n</code></pre>"},{"location":"contributing/#development-workflow","title":"\ud83d\udd04 Development Workflow","text":"<ol> <li> <p>Create a Branch: <code>git checkout -b feature/your-feature</code></p> </li> <li> <p>Make Changes:</p> </li> <li> <p>Run <code>cargo fmt</code> to format.</p> </li> <li> <p>Run <code>cargo clippy</code> to lint.</p> </li> <li> <p>Test:</p> </li> <li> <p><code>cargo test</code> (Rust unit tests)</p> </li> <li> <p><code>pytest</code> (Python integration tests)</p> </li> <li> <p>Submit PR:</p> </li> <li>Push to your fork.</li> <li>Open a Pull Request on GitHub.</li> </ol>"},{"location":"contributing/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<ul> <li><code>cytoscnpy/</code> - Rust core library &amp; analysis engine.</li> <li><code>python/</code> - Python wrapper &amp; CLI entry point.</li> <li><code>editors/vscode/</code> - VS Code extension.</li> <li><code>cytoscnpy-mcp/</code> - MCP server documentation.</li> </ul>"},{"location":"contributing/#testing","title":"\ud83e\uddea Testing","text":"<p>We have a comprehensive test suite.</p> <pre><code># Run all Rust tests\ncargo test\n\n# Run specific test\ncargo test test_name\n</code></pre> <p>See tests/README.md for detailed testing guide.</p>"},{"location":"dangerous-code/","title":"Dangerous Code Rules Reference","text":"<p>Security rules detected by the <code>--danger</code> flag, organized by category. Each category has its own detailed documentation page.</p>"},{"location":"dangerous-code/#quick-access-by-category","title":"Quick Access by Category","text":"Category Description Rule IDs Code Execution <code>eval</code>, <code>exec</code>, subprocess injection, insecure imports CSP-D0xx Injection &amp; Logic SQL injection, XSS, insecure XML, asserts CSP-D1xx Deserialization <code>pickle</code>, <code>yaml</code>, <code>marshal</code>, ML models CSP-D2xx Cryptography Weak hashes, insecure PRNG, weak ciphers CSP-D3xx Network &amp; HTTP SSRF, missing timeouts, insecure <code>requests</code> CSP-D4xx File Operations Path traversal, zip slip, bad permissions CSP-D5xx Type Safety Method misuse, logic errors CSP-D6xx Best Practices Misconfigurations, autoescape CSP-D8xx Privacy &amp; Frameworks Logging sensitive data, Django secrets CSP-D9xx"},{"location":"dangerous-code/#severity-levels","title":"Severity Levels","text":"<p>CytoScnPy classifies findings into three severity levels:</p> <ul> <li>CRITICAL: Immediate risks like RCE or unauthenticated SQLi.</li> <li>HIGH: Risky patterns like insecure deserialization or weak crypto in production.</li> <li>LOW: Sub-optimal patterns, missing timeouts, or best practice violations.</li> </ul> <p>Use the <code>--severity-threshold</code> flag to filter results:</p> <pre><code>cytoscnpy --danger --severity-threshold HIGH .\n</code></pre>"},{"location":"integrations/","title":"Integrations","text":"<p>CytoScnPy integrates with your development workflow via IDE extensions and the Model Context Protocol (MCP).</p>"},{"location":"integrations/#vs-code-extension","title":"VS Code Extension","text":"<p>Get real-time feedback while you code.</p>"},{"location":"integrations/#installation","title":"Installation","text":"<ol> <li>Search for \"CytoScnPy\" in the VS Code Marketplace.</li> <li>Install the extension.</li> </ol>"},{"location":"integrations/#commands","title":"Commands","text":"<p>Access via Command Palette (<code>Ctrl+Shift+P</code> / <code>Cmd+Shift+P</code>):</p> Command Description <code>CytoScnPy: Analyze Current File</code> Trigger analysis for the active file. <code>CytoScnPy: Analyze Workspace</code> Analyze all Python files in the workspace. <code>CytoScnPy: Calculate Cyclomatic Complexity (cc)</code> Show complexity metrics for current file. <code>CytoScnPy: Calculate Halstead Metrics (hal)</code> Show Halstead metrics for current file. <code>CytoScnPy: Calculate Maintainability Index (mi)</code> Show MI scores for current file. <code>CytoScnPy: Calculate Raw Metrics (raw)</code> Show LOC, SLOC, and other raw metrics."},{"location":"integrations/#configuration","title":"Configuration","text":"<p>Customize behavior in VS Code Settings (<code>Ctrl+,</code>):</p> <p>| <code>cytoscnpy.analysisMode</code> | <code>workspace</code> | Analysis mode: <code>workspace</code> (accurate) or <code>file</code> (fast). | | <code>cytoscnpy.enableSecretsScan</code> | <code>false</code> | Enable scanning for keys/tokens. | | <code>cytoscnpy.enableDangerScan</code> | <code>false</code> | Enable dangerous code patterns scanning. | | <code>cytoscnpy.enableQualityScan</code> | <code>false</code> | Enable code quality metrics scanning. | | <code>cytoscnpy.enableCloneScan</code> | <code>false</code> | Enable clone detection scanning. | | <code>cytoscnpy.confidenceThreshold</code> | <code>0</code> | Min confidence (0-100). 0 shows all findings. | | <code>cytoscnpy.excludeFolders</code> | <code>[]</code> | Folders to exclude from analysis. | | <code>cytoscnpy.includeFolders</code> | <code>[]</code> | Folders to force-include in analysis. | | <code>cytoscnpy.includeTests</code> | <code>false</code> | Include test files in analysis. | | <code>cytoscnpy.includeIpynb</code> | <code>false</code> | Include Jupyter Notebooks (.ipynb files). | | <code>cytoscnpy.maxComplexity</code> | <code>10</code> | Maximum allowed Cyclomatic Complexity. | | <code>cytoscnpy.minMaintainabilityIndex</code> | <code>40</code> | Minimum Maintainability Index. | | <code>cytoscnpy.maxNesting</code> | <code>3</code> | Maximum allowed nesting depth. | | <code>cytoscnpy.maxArguments</code> | <code>5</code> | Maximum allowed function arguments. | | <code>cytoscnpy.maxLines</code> | <code>50</code> | Maximum allowed function lines. | | <code>cytoscnpy.path</code> | <code>\"\"</code> | Custom path to CLI executable. |</p>"},{"location":"integrations/#mcp-server-ai-assistants","title":"MCP Server (AI Assistants)","text":"<p>Enable AI assistants (Claude, Cursor, Copilot) to use CytoScnPy tools.</p> <p>Note: HTTP/SSE transport is planned for future releases to enable remote analysis. See Roadmap for details.</p>"},{"location":"integrations/#github-copilot","title":"GitHub Copilot","text":"<p>The VS Code extension automatically registers the MCP server. Just ask Copilot:</p> <p>\"Run a security scan on this file\"</p>"},{"location":"integrations/#manual-setup-claudecursor","title":"Manual Setup (Claude/Cursor)","text":"<p>If not using VS Code, run the server manually:</p> <pre><code>cytoscnpy mcp-server\n</code></pre> <p>Claude Desktop Config:</p> <pre><code>{\n  \"mcpServers\": {\n    \"cytoscnpy\": {\n      \"command\": \"cytoscnpy\",\n      \"args\": [\"mcp-server\"]\n    }\n  }\n}\n</code></pre>"},{"location":"integrations/#available-tools","title":"Available Tools","text":"<p>When connected, CytoScnPy exposes the following tools to Claude/Copilot:</p> Tool Description <code>analyze_path</code> Full analysis on files/directories. (Secrets, Danger, Quality, Taint) <code>analyze_code</code> Analyze a code snippet directly. <code>quick_scan</code> Fast security scan (Secrets &amp; Dangerous patterns). <code>cyclomatic_complexity</code> Calculate complexity metrics for a path. <code>maintainability_index</code> Calculate MI scores (0-100) for a path."},{"location":"integrations/#configuration_1","title":"Configuration","text":""},{"location":"integrations/#claude-desktop","title":"Claude Desktop","text":"<p>Add to <code>claude_desktop_config.json</code>:</p> <pre><code>{\n  \"mcpServers\": {\n    \"cytoscnpy\": {\n      \"command\": \"cytoscnpy\",\n      \"args\": [\"mcp-server\"]\n    }\n  }\n}\n</code></pre>"},{"location":"integrations/#github-copilot-vs-code","title":"GitHub Copilot (VS Code)","text":"<p>Automatically enabled when the VS Code Extension is installed. No extra config needed.</p>"},{"location":"migration/","title":"Migration Guide","text":""},{"location":"migration/#upgrading-to-v125","title":"Upgrading to v1.2.5","text":""},{"location":"migration/#ci-workflow-improvements","title":"CI Workflow Improvements","text":"<ul> <li>Python 3.13 Support: If you are using <code>pip install</code> on Linux with Python 3.13, you no longer need the standalone installer as a workaround. Wheels are now explicitly built for Python 3.9 through 3.13 for all supported platforms.</li> </ul>"},{"location":"migration/#upgrading-to-v122","title":"Upgrading to v1.2.2","text":""},{"location":"migration/#behavioral-changes","title":"Behavioral Changes","text":"<ul> <li>Test Exclusion: Starting from v1.2.2, tests are excluded by default in both the CLI and library API to reduce noise. Use the <code>--include-tests</code> flag if you want to scan your test files.</li> </ul>"},{"location":"migration/#upgrading-to-v120","title":"Upgrading to v1.2.0","text":""},{"location":"migration/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>Pre-commit Hooks: The hook <code>rev</code> should be updated to <code>v1.2.1</code> in your <code>.pre-commit-config.yaml</code>.</li> <li>Parser Engine: Switched from <code>rustpython-parser</code> to <code>ruff_python_parser</code>. This improves performance and Python 3.12+ compatibility but may handle syntax errors more strictly.</li> </ul>"},{"location":"migration/#command-line-interface","title":"Command Line Interface","text":"<ul> <li>Subcommands: Metric calculations are now grouped under subcommands (<code>raw</code>, <code>cc</code>, <code>hal</code>, <code>mi</code>, <code>stats</code>, <code>files</code>).</li> <li>Old: <code>cytoscnpy --raw</code> (hypothetical legacy)</li> <li>New: <code>cytoscnpy raw .</code></li> <li>Output: The <code>stats</code> subcommand with <code>--all</code> is the recommended default for CI pipelines requiring full analysis.</li> </ul>"},{"location":"migration/#configuration","title":"Configuration","text":"<ul> <li>Notebooks: <code>include_ipynb</code> and <code>ipynb_cells</code> are currently CLI-only flags. Verify they are passed in your command line arguments, as they are not yet supported in <code>.cytoscnpy.toml</code>.</li> </ul>"},{"location":"migration/#upgrading-from-v10x","title":"Upgrading from v1.0.x","text":""},{"location":"migration/#feature-flags","title":"Feature Flags","text":"<ul> <li>CFG Support: Control Flow Graph analysis is now an opt-in feature. Build with <code>--features cfg</code> if you rely on deep behavioral analysis for clone detection.</li> </ul>"},{"location":"migration/#python-api","title":"Python API","text":"<ul> <li>Entry Point: The <code>cytoscnpy.run()</code> function is the stable entry point. Direct access to internal modules is not guaranteed.</li> </ul>"},{"location":"pre-commit/","title":"Pre-commit Hooks","text":"<p>CytoScnPy provides several pre-commit hooks to automate code analysis in your local development workflow. This ensures that unused code, security vulnerabilities, and quality issues are caught before they reach your repository.</p>"},{"location":"pre-commit/#installation","title":"Installation","text":"<ol> <li> <p>Install pre-commit:</p> <pre><code>pip install pre-commit\n</code></pre> </li> <li> <p>Add Configuration: Create or update <code>.pre-commit-config.yaml</code> in your project root:</p> <pre><code>repos:\n  - repo: https://github.com/djinn09/CytoScnPy\n    rev: v1.2.1 # Use the latest release tag\n    hooks:\n      - id: cytoscnpy-check\n        # Optional: custom arguments\n        # args: ['--confidence', '60', '--danger', '--quality']\n</code></pre> </li> <li> <p>Install Hooks:     <pre><code>pre-commit install\n</code></pre></p> </li> </ol>"},{"location":"pre-commit/#available-hooks","title":"Available Hooks","text":"Hook ID Description Recommended For <code>cytoscnpy-check</code> Full analysis (security + quality + dead code) General protection <code>cytoscnpy-danger</code> Scans for dangerous patterns (SQLi, XSS, etc.) Security-focused projects <code>cytoscnpy-secrets</code> Scans for hardcoded credentials/API keys All projects <code>cytoscnpy-quality</code> Checks CC, MI, and unused code Maintaining code health <code>cytoscnpy-security</code> <code>cytoscnpy-danger</code> + <code>cytoscnpy-secrets</code> Security hardening"},{"location":"pre-commit/#usage-best-practices","title":"Usage &amp; Best Practices","text":""},{"location":"pre-commit/#selective-analysis","title":"Selective Analysis","text":"<p>If you only want to fail on security issues but want to see quality warnings, use separate hooks:</p> <pre><code>- id: cytoscnpy-security\n  args: [\"--fail-threshold\", \"0\"]\n- id: cytoscnpy-quality\n  args: [\"--fail-on-quality\", \"false\"]\n</code></pre>"},{"location":"pre-commit/#strictness-levels","title":"Strictness Levels","text":"<p>You can enforce strict quality gates using these flags in <code>args</code>:</p> <ul> <li><code>--fail-on-quality</code>: Exit with code 1 if any quality issues are found.</li> <li><code>--fail-threshold &lt;N&gt;</code>: Fail if unused code percentage exceeds N.</li> <li><code>--max-complexity &lt;N&gt;</code>: Fail if any function exceeds complexity N.</li> </ul>"},{"location":"pre-commit/#performance","title":"Performance","text":"<p>CytoScnPy is built in Rust and is designed to be extremely fast. However, for very large monorepos, you may want to limit the frequency:</p> <pre><code>- id: cytoscnpy-check\n  stages: [push] # Only run on push instead of every commit\n</code></pre>"},{"location":"pre-commit/#troubleshooting","title":"Troubleshooting","text":""},{"location":"pre-commit/#too-many-open-files","title":"\"Too many open files\"","text":"<p>If running on thousands of files at once, you might hit OS limits. You can limit the hook to specific directories:</p> <pre><code>hooks:\n  - id: cytoscnpy-check\n    files: ^src/\n</code></pre>"},{"location":"pre-commit/#suppression","title":"Suppression","text":"<p>To ignore a specific finding on a line, use any of these formats:</p> <pre><code>def legacy_function():  # noqa\n    pass  # bare noqa suppresses all\n\nunused_var = 1  # ignore\n    # bare ignore also suppresses all\n\nsecret_key = \"...\"  # pragma: no cytoscnpy\n    # legacy format, still supported\n\nother_var = value  # noqa: E501, CSP\n    # mixed codes: suppresses CytoScnPy because CSP is in the list\n</code></pre> <p>[!NOTE] Inline suppression comments (<code># noqa</code>, <code># ignore</code>, <code># pragma: no cytoscnpy</code>) apply to dead code, security, quality, and clone findings on a specific line. For ignoring rules across the entire project, use the <code>ignore</code> list in your <code>.cytoscnpy.toml</code> configuration file.</p>"},{"location":"quality/","title":"Code Quality Rules","text":"<p>CytoScnPy detects common Python code quality issues and maintains alignment with industry-standard linting codes (Flake8, Bugbear, Pylint).</p> <p>Enable quality analysis with the <code>--quality</code> flag:</p> <pre><code>cytoscnpy . --quality\n</code></pre>"},{"location":"quality/#best-practices","title":"Best Practices","text":"Name Description <code>MutableDefaultArgumentRule</code> Detects mutable default arguments (lists, dicts, sets). <code>BareExceptRule</code> Detects <code>except:</code> blocks without a specific exception class. <code>DangerousComparisonRule</code> Detects comparisons to <code>True</code>, <code>False</code>, or <code>None</code> using <code>==</code> instead of <code>is</code>."},{"location":"quality/#maintainability-complexity","title":"Maintainability &amp; Complexity","text":"Name Description <code>ComplexityRule</code> Function cyclomatic complexity (McCabe) exceeds threshold. <code>NestingRule</code> Code block is nested too deeply. <code>ArgumentCountRule</code> Function has too many arguments. <code>FunctionLengthRule</code> Function is too long (lines of code)."},{"location":"quality/#configuration","title":"Configuration","text":"<p>You can tune the thresholds for quality rules in your <code>.cytoscnpy.toml</code>:</p> <pre><code>[cytoscnpy]\nmax_complexity = 15    # Default: 10\nmax_nesting = 4        # Default: 3\nmax_args = 6           # Default: 5\nmax_lines = 100        # Default: 50\n</code></pre>"},{"location":"quality/#suppression","title":"Suppression","text":"<p>Use the standard <code># noqa</code> syntax to suppress specific findings. Note that Rule IDs for quality checks are currently under migration; use generic <code># noqa</code> to suppress all quality findings on a line:</p> <pre><code>def my_function(arg=[]):  # noqa\n    pass\n\ntry:\n    do_something()\nexcept:  # noqa\n    pass\n</code></pre>"},{"location":"roadmap/","title":"CytoScnPy - Roadmap &amp; Development Guide","text":"<p>Architecture: Hybrid PyO3 + Standalone CLI Status: Production-ready core, active development</p> <p>For completed features and implementation history, see GitHub Releases.</p>"},{"location":"roadmap/#table-of-contents","title":"\ud83d\udccb Table of Contents","text":"<ol> <li>Project Status</li> <li>In Progress</li> <li>Future Roadmap</li> <li>Phase 9: Developer Experience</li> <li>Phase 10: Deep Analysis &amp; Security</li> <li>Phase 11: Auto-Remediation</li> </ol>"},{"location":"roadmap/#project-status","title":"Project Status","text":""},{"location":"roadmap/#in-progress","title":"In Progress","text":""},{"location":"roadmap/#57-radon-parity-gaps-in-progress","title":"5.7 Radon Parity Gaps \ud83d\udd04 IN PROGRESS","text":"<p>Status: Tests added, implementation pending. See <code>cytoscnpy/tests/radon_parity_*.rs</code></p> <p>These features are tested but not yet implemented. Remove <code>#[ignore]</code> from tests when implementing.</p>"},{"location":"roadmap/#complexity-gaps-19-tests-ignored","title":"Complexity Gaps (19 tests ignored)","text":"Feature Description Test File Radon Behavior Module-level complexity Complexity of code outside functions <code>radon_parity_complexity_test.rs</code> Radon reports module-level <code>if</code>/<code>for</code>/<code>while</code> etc. For/while else clause <code>else:</code> on loops adds +1 complexity <code>radon_parity_complexity_test.rs</code> Radon counts loop <code>else:</code> as branch Try-except else clause <code>else:</code> on try adds +1 complexity <code>radon_parity_complexity_test.rs</code> Radon counts try <code>else:</code> as branch Lambda ternary Ternary inside lambda adds complexity <code>radon_parity_complexity_test.rs</code> Ternary in lambda body counts Ternary with generator Generator inside ternary <code>radon_parity_complexity_test.rs</code> Nested comprehension complexity Match wildcard <code>case _:</code> shouldn't add complexity <code>radon_parity_complexity_test.rs</code> Wildcard is default, not branch Nested generator Inner generator adds complexity <code>radon_parity_complexity_test.rs</code> Each <code>for</code>/<code>if</code> in nested generator Class method <code>or</code> Boolean <code>or</code> in condition <code>radon_parity_complexity_test.rs</code> <code>or</code> adds +1 complexity"},{"location":"roadmap/#halstead-gaps-1-test-ignored","title":"Halstead Gaps (1 test ignored)","text":"Feature Description Test File Radon Behavior Distinct operand counting <code>if a and b: elif b or c:</code> <code>radon_parity_halstead_test.rs</code> <code>b</code> counted once as distinct"},{"location":"roadmap/#raw-metrics-gaps-2-tests-ignored","title":"Raw Metrics Gaps (2 tests ignored)","text":"Feature Description Test File Radon Behavior Line continuation with string Backslash + multiline string <code>radon_parity_raw_test.rs</code> Continuation counted correctly Line continuation with comment Backslash + inline comment <code>radon_parity_raw_test.rs</code> Comment on continuation line"},{"location":"roadmap/#implementation-priority","title":"Implementation Priority","text":"<ol> <li>Module-level complexity - High impact (8 tests), required for full Radon parity</li> <li>Loop/try else clauses - Medium impact (5 tests), common pattern</li> <li>Match wildcard handling - Low impact (2 tests), Python 3.10+ only</li> <li>Halstead/Raw edge cases - Low impact (3 tests), edge cases</li> </ol>"},{"location":"roadmap/#phase-8-cfg-integration-done","title":"Phase 8: CFG Integration \u2705 DONE","text":""},{"location":"roadmap/#81-control-flow-graph-construction","title":"8.1 Control Flow Graph Construction \u2705","text":"<p>Implemented CFG construction from Python AST for behavioral analysis:</p> <ul> <li>CFG Builder: Constructs basic blocks from <code>StmtFunctionDef</code></li> <li>Control Flow: Handles <code>if</code>, <code>for</code>, <code>while</code>, <code>try</code>, <code>match</code>, <code>break</code>, <code>continue</code>, <code>return</code>, <code>raise</code></li> <li>Loop Depth: Tracks nesting depth for each basic block</li> <li>Fingerprinting: Behavioral signature for clone comparison</li> </ul>"},{"location":"roadmap/#82-clone-detection-integration","title":"8.2 Clone Detection Integration \u2705","text":"<p>CFG validation as secondary filter for clone detection:</p> Feature Description <code>cfg_validation</code> config Enable/disable CFG validation in <code>CloneConfig</code> <code>validate_with_cfg()</code> Phase 4.5 filter in <code>CloneDetector::detect()</code> <code>cfg_validated</code> context +15 confidence boost in <code>ConfidenceScorer</code> 70% similarity threshold CFG pairs below this are filtered out"},{"location":"roadmap/#83-feature-flag","title":"8.3 Feature Flag","text":"<p>Enabled via <code>--features cfg</code> at compile time:</p> <pre><code>cargo build --features cfg\ncargo test --features cfg\n</code></pre>"},{"location":"roadmap/#phase-6-editor-integration-done","title":"Phase 6: Editor Integration \u2705 DONE","text":""},{"location":"roadmap/#61-vs-code-extension-in-progress","title":"6.1 VS Code Extension \ud83d\udd04 IN PROGRESS","text":""},{"location":"roadmap/#62-extension-code-audit-pending-fixes-in-progress","title":"6.2 Extension Code Audit (Pending Fixes) \ud83d\udd04 IN PROGRESS","text":""},{"location":"roadmap/#623-json-parsing-completeness","title":"6.2.3 JSON Parsing Completeness \u2705","text":"<p>Fields in CLI JSON output not captured by <code>analyzer.ts</code>:</p> <ul> <li>[ ] Add <code>summary</code> stats display in output channel</li> </ul>"},{"location":"roadmap/#624-missing-commands","title":"6.2.4 Missing Commands \ud83d\udd04","text":"Command Description Status <code>cytoscnpy.taintAnalysis</code> Run taint analysis specifically \u274c"},{"location":"roadmap/#625-path-handling","title":"6.2.5 Path Handling \u2705","text":"<ul> <li>[ ] Add macOS (<code>cytoscnpy-cli-darwin</code>) binary bundling</li> <li>[ ] Add Linux (<code>cytoscnpy-cli-linux</code>) binary bundling</li> </ul>"},{"location":"roadmap/#626-ux-enhancements","title":"6.2.6 UX Enhancements","text":"Feature Description Priority Status Status Bar Show finding count in status bar Medium \u274c Sidebar Badge Show issue count in Explorer sidebar Medium \u2705 Quick Fixes Code actions to remove/comment unused code High \u2705 Gutter Decorations Visual icons for severity levels Low \u2705 Progress Indicator Show progress during workspace analysis Medium \u274c File Caching Skip re-analyzing unchanged files Low \u2705 Problem Grouping Better categorization in Problems panel Low \u2705"},{"location":"roadmap/#phase-7-infrastructure-quality-done","title":"Phase 7: Infrastructure &amp; Quality \u2705 DONE","text":""},{"location":"roadmap/#72-error-handling","title":"7.2 Error Handling \u2705","text":""},{"location":"roadmap/#73-parser-migration-rustpython-parser-ruff_python_parser","title":"7.3 Parser Migration: <code>rustpython-parser</code> \u2192 <code>ruff_python_parser</code> \u2705","text":"<p>Reference: See RustPython/Cargo.toml for working example.</p>"},{"location":"roadmap/#phase-75-performance-optimizations-done","title":"Phase 7.5: Performance Optimizations \u2705 DONE","text":""},{"location":"roadmap/#pending-optimizations-low-priority","title":"\ud83d\udd04 Pending Optimizations (Low Priority)","text":"Optimization Description Priority Complexity Est. Impact Reduce remaining <code>.clone()</code> calls Audit and eliminate unnecessary clones (~50+ remaining) Low Low 2-5% String interning Use <code>string-cache</code> crate for repeated strings (module names, type names) Low Medium 3-5% Profile-Guided Optimization (PGO) Build with profile data for 5-10% improvement Low Medium 5-10% Parallel AST traversal Split large files for parallel statement processing Very Low High 10-20% on large files"},{"location":"roadmap/#not-needed-deferred","title":"\u274c Not Needed / Deferred","text":"Optimization Reason Scope resolution caching Already optimized via <code>cached_scope_prefix</code> Arc\\&lt;String&gt; for module_name Would require significant refactoring, marginal benefit FxHashSet audit Already using <code>FxHashSet</code> in most places"},{"location":"roadmap/#phase-76-accuracy-improvements-in-progress","title":"Phase 7.6: Accuracy Improvements \ud83d\udd04 IN PROGRESS","text":"<p>Systematic improvements to detection accuracy based on benchmark analysis.</p> <p>Current Status: F1 = 0.72 (110 TP, 46 FP, 38 FN)</p>"},{"location":"roadmap/#761-completed-fixes","title":"7.6.1 Completed Fixes \u2705","text":"<ul> <li>[x] Framework Decorator Tracking: Accurate detection for FastAPI, Django, and Celery entry points.</li> <li>[x] TYPE_CHECKING Block Handling: Correctly ignores imports used only in type-check blocks.</li> <li>[x] F-string Reference Detection: Tracking variables and functions referenced within f-string interpolations.</li> <li>[x] Multi-line String LOC: Improved metrics for backslash-continued strings and comments.</li> </ul>"},{"location":"roadmap/#762-remaining-false-positives-34-items","title":"7.6.2 Remaining False Positives (34 items)","text":"<p>Items incorrectly flagged as unused.</p> Category Count Issue Priority Fix Difficulty Functions 17 Closures, returned functions, pattern matching bindings High Medium Imports 6 Cross-file <code>__all__</code> re-exports, FastAPI <code>Depends</code> High Medium Variables 6 Closure captures, complex scoping Medium Hard Methods 3 Pydantic <code>from_dict</code>/<code>to_dict</code> patterns Low Easy Classes 2 FastAPI response models (<code>In</code>, <code>Out</code>) Low Easy"},{"location":"roadmap/#priority-1-cross-file-__all__-tracking","title":"Priority 1: Cross-File <code>__all__</code> Tracking","text":"<p>Problem: Imports re-exported via <code>__all__</code> in other modules are flagged:</p> <pre><code># module_a.py\nfrom module_b import ExportedClass  # Flagged as unused\n\n# module_b.py\n__all__ = [\"ExportedClass\"]  # Should mark as used across files\n</code></pre> <p>Solution: Track <code>__all__</code> exports globally and match against imports in other files.</p>"},{"location":"roadmap/#priority-2-pattern-matching-bindings","title":"Priority 2: Pattern Matching Bindings","text":"<p>Problem: Variables bound in <code>match</code> statements are flagged:</p> <pre><code>match command:\n    case (action, value):  # 'action' and 'value' flagged as unused\n        handle(action, value)\n</code></pre> <p>Solution: Track <code>match</code> case bindings as references.</p>"},{"location":"roadmap/#priority-3-returned-inner-functions","title":"Priority 3: Returned Inner Functions","text":"<p>Problem: Functions returned from factory functions are flagged:</p> <pre><code>def factory():\n    def inner():  # Flagged as unused\n        pass\n    return inner  # Should mark 'inner' as used\n</code></pre> <p>Status: \u2705 Fixed in return statement tracking improvements.</p>"},{"location":"roadmap/#763-remaining-false-negatives-60-items","title":"7.6.3 Remaining False Negatives (60 items)","text":"<p>Genuinely unused items we fail to detect.</p> Category Count Issue Priority Fix Difficulty Functions 19 Pragma-ignored, security examples, FastAPI deps Low N/A (intentional) Variables 18 Complex scoping, pattern matching, class attrs High Medium Imports 12 Various tracking gaps Medium Medium Methods 10 Methods inside unused classes not linked High Medium Classes 1 Complex inheritance patterns Low Hard"},{"location":"roadmap/#priority-1-class-method-linking-done","title":"Priority 1: Class-Method Linking \u2705 DONE","text":"<p>Problem: Methods inside unused classes are not detected.</p> <pre><code>class UnusedClass:  # Detected as unused \u2705\n    def method(self):  # NOW detected via cascading detection \u2705\n        pass\n</code></pre> <p>Solution: When a class is unused, automatically mark all its methods as unused (cascading deadness).</p> <p>Implementation: Modified <code>aggregate_results()</code> and <code>analyze_code()</code> in <code>processing.rs</code> to flag all methods within unused classes. Respects heuristic protections (visitor pattern methods are excluded).</p>"},{"location":"roadmap/#priority-2-variable-scope-improvements","title":"Priority 2: Variable Scope Improvements","text":"<p>Problem: Local variables in complex scopes are missed.</p> <pre><code>def func():\n    x = 1  # Never used after assignment - should be flagged\n    y = process()\n    return y\n</code></pre> <p>Solution: Improve variable liveness analysis within function scopes.</p>"},{"location":"roadmap/#priority-3-import-detection-gaps","title":"Priority 3: Import Detection Gaps","text":"<p>Problem: Some import patterns not detected:</p> <ul> <li>Imports in type annotations without string quotes</li> <li>Imports used only in comprehensions</li> <li>Star imports (<code>from x import *</code>)</li> </ul>"},{"location":"roadmap/#764-accuracy-improvement-roadmap","title":"7.6.4 Accuracy Improvement Roadmap","text":"Phase Target F1 Key Fixes Status 7.6.1 0.63 Return annotations, TYPE_CHECKING \u2705 Done 7.6.2 0.68 Cross-file <code>__all__</code>, pattern matching \ud83d\udd04 Planned 7.6.3 0.72 Class-method linking, variable scopes \ud83d\udd04 Planned 7.6.4 0.75 Import gaps, framework patterns \ud83d\udd04 Planned"},{"location":"roadmap/#phase-8-advanced-framework-support-done","title":"Phase 8: Advanced Framework Support \u2705 DONE","text":"<p>Django, FastAPI, Pydantic is done \u2705.</p>"},{"location":"roadmap/#future-roadmap","title":"Future Roadmap","text":""},{"location":"roadmap/#phase-9-developer-experience","title":"Phase 9: Developer Experience","text":"<p>Tools to improve the workflow around CytoScnPy.</p> <ul> <li>[x] Git Hooks (pre-commit) \u2705</li> <li>Automated analysis on commit/push.</li> <li>See <code>docs/pre-commit.md</code> for setup instructions.</li> <li>[x] CI/CD Integration Examples \u2705</li> <li>Reference workflows for GitHub Actions provided in <code>.github/workflows/</code>.</li> <li>Supports <code>--fail-on-quality</code> and <code>--fail-threshold</code> for gatekeeping.</li> <li>[x] uv Package Manager Integration \u2705</li> <li>Full support for <code>uv</code>-managed environments.</li> <li> <p>Used in official lint/CI workflows.</p> </li> <li> <p>[ ] MCP HTTP/SSE Transport</p> </li> <li>Add HTTP/SSE transport for remote LLM integrations (web-based clients, APIs).</li> <li>Challenges to Address:<ul> <li>Path validation/sandboxing for security</li> <li>Timeout handling for large project analysis (30-60s)</li> </ul> </li> <li>Remote Analysis Tools:     | Tool | Input | Use Case |     |------|-------|----------|     | <code>analyze_code</code> | Code string | Small snippets (already works) |     | <code>analyze_files</code> | JSON map of files | Medium projects via upload |     | <code>analyze_repo</code> | Git URL | Clone &amp; analyze public repos |     | <code>analyze_path</code> | Local path | Server-local files only |</li> <li> <p>Implementation:</p> <ul> <li>Add <code>--http --port 3000</code> CLI flags for transport selection</li> <li>Use <code>rmcp</code> SSE transport feature</li> <li>Add Git clone support for <code>analyze_repo</code> tool</li> </ul> </li> <li> <p>[ ] LSP Server (Language Server Protocol)</p> </li> <li>Implement a real-time LSP server for VS Code, Neovim, and Zed.</li> <li> <p>Provide instant diagnostics without saving or running CLI.</p> </li> <li> <p>[ ] Config File Support for Notebook Options</p> </li> <li>Allow <code>include_ipynb</code> and <code>ipynb_cells</code> in <code>.cytoscnpy.toml</code> and <code>pyproject.toml</code></li> <li>Currently these are CLI-only flags (<code>--include-ipynb</code>, <code>--ipynb-cells</code>)</li> <li>Rationale: Enable persistent configuration without passing flags on every run</li> <li> <p>Implementation: Add fields to <code>CytoScnPyConfig</code> struct in <code>src/config.rs</code></p> </li> <li> <p>[ ] Git Integration</p> </li> <li>Blame Analysis: Identify who introduced unused code.</li> <li> <p>Incremental Analysis: Analyze only files changed in the current PR/commit.</p> </li> <li> <p>[x] HTML Report Generation \u2705</p> </li> <li>Generate self-contained HTML reports for large codebase analysis.</li> <li>Features:<ul> <li>Syntax highlighting (using highlight.js or prism.js)</li> <li>Clickable file links with line numbers</li> <li>Filtering by type (unused, security, quality), severity, file</li> <li>Search across all findings</li> <li>Summary dashboard with charts</li> <li>Code snippets showing context around each finding (Basic impl done, see Phase 9.5 for improvements)</li> </ul> </li> <li>CLI: <pre><code>cytoscnpy ./project --html\n# Multi-file support planned for large projects\n</code></pre></li> <li> <p>Implementation:</p> <ul> <li>Use <code>tera</code> or <code>askama</code> for templating</li> <li>Embed CSS/JS for self-contained output</li> <li>Optional: Split large reports into multiple HTML files with index</li> </ul> </li> <li> <p>[x] Security Documentation Overhaul \u2705</p> </li> <li>Categorized all 50+ danger rules into logical modules (Code Execution, Injection, etc.).</li> <li>Ensured 1:1 parity between documentation and Rust implementation (severities, patterns).</li> <li>Added safer alternatives and remediation advice for all rules.</li> <li> <p>See Dangerous Code Rules for details.</p> </li> <li> <p>[ ] Live Server Mode</p> </li> <li>Built-in HTTP server to browse analysis results interactively.</li> <li>Features:<ul> <li>Auto-refresh on file changes (watch mode)</li> <li>REST API for findings (JSON endpoints)</li> <li>Interactive code browser with inline annotations</li> <li>Severity/type filters with live updates</li> </ul> </li> <li>CLI: <pre><code>cytoscnpy serve ./project --port 8080\n</code></pre></li> <li>Technical Approach:<ul> <li>Use <code>axum</code> or <code>warp</code> for lightweight HTTP server</li> <li>WebSocket for live updates</li> <li>Serve static HTML + JSON API</li> </ul> </li> <li>Use Cases:<ul> <li>Team code review sessions</li> <li>CI/CD dashboard integration</li> <li>Local development feedback loop</li> </ul> </li> </ul>"},{"location":"roadmap/#phase-95-report-actionability-upgrade-planned","title":"Phase 9.5: Report Actionability Upgrade \ud83d\udd04 PLANNED","text":"<p>Implementing findings from the Recommendation System Audit.</p> <p>Goal: Transform the report from a diagnostic tool into a remediation platform.</p> <ul> <li>[ ] Remediation Display Engine (Priority: HIGH)</li> <li>Problem: Backend has remediation data (e.g., \"Use parameterized queries\"), but it's lost during report generation.</li> <li> <p>Solution:</p> <ul> <li>Extend <code>IssueItem</code> struct with <code>remediation</code> and <code>vuln_type</code> fields.</li> <li>Update <code>flatten_issues</code> to preserve <code>SinkInfo</code> remediation strings.</li> <li>Update <code>issues.html</code> and <code>file_view.html</code> to display a collapsible \"Remediation\" box.</li> </ul> </li> <li> <p>[ ] Context-Aware Code Snippets (Priority: MEDIUM)</p> </li> <li>Problem: Issues are shown as one-liners without context.</li> <li> <p>Solution:</p> <ul> <li>Extract 3-5 lines of code around the issue location.</li> <li>Display syntax-highlighted snippets inline in the Issues tab.</li> </ul> </li> <li> <p>[ ] Enriched Quality Messages (Priority: MEDIUM)</p> </li> <li>Problem: Generic messages like \"Function too complex\" offer no guidance.</li> <li> <p>Solution: Map rule IDs to specific refactoring advice (e.g., \"Extract reusable logic into helper functions\").</p> </li> <li> <p>[ ] Prioritization Framework (Priority: LOW)</p> </li> <li>Problem: All high-severity issues look the same.</li> <li>Solution: Add \"Exploitability\" and \"Fix Effort\" scores to help teams prioritize.</li> </ul>"},{"location":"roadmap/#benchmarking-infrastructure-ideas","title":"Benchmarking Infrastructure Ideas","text":"Component Description Tools/Approaches Containerized Execution Isolated, reproducible environments Docker, Podman Cross-Platform Matrix Test on Windows, Linux, macOS GitHub Actions matrix Python Version Matrix Test with Python 3.8-3.12 tox, nox Memory Profiling Track peak RSS, allocations tracemalloc, memory_profiler CPU Profiling Identify bottlenecks py-spy, cProfile Differential Testing Compare outputs between tool versions Custom diff scripts Regression Testing Detect accuracy/performance regressions Baseline JSON comparison"},{"location":"roadmap/#suggested-future-improvements","title":"Suggested Future Improvements","text":"<ol> <li>Expand Ground Truth: Add more test cases for edge cases (decorators, type hints, async code)</li> <li>Real-World Validation: Run on popular open-source projects (Django, Flask, requests)</li> <li>Add MCC Metric: Better handles imbalanced detection categories</li> <li>Per-File Breakdown: Show which specific test files each tool struggles with</li> <li>Confidence Threshold Sweep: Test Vulture at multiple confidence levels (0%, 30%, 60%, 90%)</li> <li>Cross-Language Comparison: Compare Python tools with similar tools for other languages</li> </ol>"},{"location":"roadmap/#phase-10-deep-analysis-security","title":"Phase 10: Deep Analysis &amp; Security","text":"<p>Pushing the boundaries of static analysis.</p> <ul> <li>[x] Secret Scanning 2.0</li> <li> <p>Enhance regex scanning with entropy analysis to reduce false positives for API keys.</p> </li> <li> <p>[x] AST-Based Suspicious Variable Detection (Secret Scanning 3.0) \u2705</p> </li> <li>Problem: Current regex patterns only detect secrets when the value matches a known format (e.g., <code>ghp_xxx</code>). This misses hardcoded secrets assigned to suspiciously named variables:     <pre><code>database_password = \"hunter2\"        # Missed - no pattern match\nconfig['api_secret'] = some_value    # Missed - dict subscript\n</code></pre></li> <li>Solution: Leverage existing <code>CytoScnPyVisitor</code> AST traversal to detect assignments to suspicious variable names, regardless of the value format.</li> <li> <p>Implementation:</p> <pre><code>// In visitor.rs - when visiting Assign nodes:\nconst SUSPICIOUS_NAMES: &amp;[&amp;str] = &amp;[\n    \"password\", \"secret\", \"key\", \"token\", \"auth\", \"credential\",\n    \"api_key\", \"apikey\", \"private_key\", \"access_token\", \"pwd\"\n];\n\nfn matches_suspicious_name(name: &amp;str) -&gt; bool {\n    let lower = name.to_lowercase();\n    SUSPICIOUS_NAMES.iter().any(|s| lower.contains(s))\n}\n\n// When visiting an Assign node:\nif matches_suspicious_name(&amp;target_name) {\n    if let Some(string_value) = extract_string_value(&amp;node.value) {\n        findings.push(SecretFinding {\n            message: format!(\"Suspicious assignment to '{}'\", target_name),\n            rule_id: \"CSP-S300\".to_owned(),\n            file: file_path.clone(),\n            line: node.range.start.row.get(),\n            severity: \"MEDIUM\".to_owned(),\n            matched_value: Some(redact_value(&amp;string_value)),\n            entropy: None,\n        });\n    }\n}\n</code></pre> </li> <li> <p>Patterns to Detect:</p> <ul> <li>Simple assignments: <code>db_password = \"secret123\"</code></li> <li>Dict subscripts: <code>config['api_key'] = \"token\"</code></li> <li>Attribute assignments: <code>self.secret_key = \"value\"</code></li> </ul> </li> <li>False Positive Mitigation:<ul> <li>Skip if value is <code>os.environ.get(...)</code> or <code>os.getenv(...)</code></li> <li>Skip if value references another variable (non-literal)</li> <li>Skip if in test files (lower severity)</li> </ul> </li> <li>Files: <code>src/visitor.rs</code>, <code>src/rules/secrets.rs</code></li> <li> <p>New Rule ID: <code>CSP-S300</code> (Suspicious Variable Assignment)</p> </li> <li> <p>[x] Modular Secret Recognition Engine (Secret Scanning 4.0) \u2705</p> </li> <li> <p>Goal: Refactor secret detection into a pluggable, trait-based architecture with unified context-based scoring.</p> </li> <li> <p>Architecture: <pre><code>SecretScanner (Orchestrator)\n       \u2502\n       \u251c\u2500\u2500 RegexRecognizer (built-in patterns)\n       \u251c\u2500\u2500 AstRecognizer (variable name detection)\n       \u251c\u2500\u2500 EntropyRecognizer (high-entropy strings)\n       \u2514\u2500\u2500 CustomRecognizer (user-defined via TOML)\n                  \u2502\n                  \u25bc\n          Context Scoring Engine\n          (proximity, file type, pragma, dedup)\n                  \u2502\n                  \u25bc\n          Final Findings (scored &amp; filtered)\n</code></pre></p> </li> <li>Pluggable Recognizers (Trait-based): <pre><code>pub trait SecretRecognizer: Send + Sync {\n    fn name(&amp;self) -&gt; &amp;str;\n    fn base_score(&amp;self) -&gt; u8;  // 0-100\n    fn scan(&amp;self, content: &amp;str, line: usize) -&gt; Vec&lt;RawFinding&gt;;\n}\n</code></pre></li> <li>Context-Based Scoring Rules:     | Signal | Adjustment | Rationale |     |--------|------------|-----------|     | Near keyword (<code>api_key=</code>) | +20 | High confidence |     | In test file | -50 | Likely fake |     | In comment | -10 | Documentation |     | High entropy | +15 | Random = suspicious |     | Known FP pattern (URL/path) | -100 | Skip |     | <code>os.environ.get()</code> | -100 | Not hardcoded |</li> <li> <p>Configuration (TOML):</p> <pre><code>[secrets]\nmin_score = 50  # Only report &gt;= 50\n\n[secrets.recognizers.ast]\nsuspicious_names = [\"password\", \"secret\", \"key\", \"token\"]\n\n[[secrets.custom_recognizers]]\nname = \"Internal Token\"\nregex = \"INTERNAL_[A-Z0-9]{16}\"\nscore = 90\n</code></pre> </li> <li> <p>Implementation Plan:</p> <ol> <li>Add <code>confidence: u8</code> to <code>SecretFinding</code> struct</li> <li>Create <code>SecretRecognizer</code> trait in <code>src/rules/recognizers/mod.rs</code></li> <li>Refactor existing patterns into <code>RegexRecognizer</code></li> <li>Implement <code>AstRecognizer</code> (CSP-S300)</li> <li>Create <code>ContextScorer</code> with scoring rules</li> <li>Update <code>scan_secrets()</code> to use orchestrator pattern</li> <li>Add TOML config for custom recognizers</li> </ol> </li> <li> <p>Files:</p> <ul> <li><code>src/rules/secrets.rs</code> \u2192 <code>src/rules/secrets/mod.rs</code> (split)</li> <li><code>src/rules/secrets/recognizers.rs</code> (new)</li> <li><code>src/rules/secrets/scoring.rs</code> (new)</li> <li><code>src/config.rs</code> (extend <code>SecretsConfig</code>)</li> </ul> </li> <li> <p>[ ] Dependency Graph \ud83d\udd04 IN PROGRESS</p> </li> <li>Generate DOT/Mermaid graphs of module dependencies to aid refactoring.</li> <li> <p>Core <code>CallGraph</code> infrastructure implemented in <code>cytoscnpy/src/taint/call_graph.rs</code>.</p> </li> <li> <p>[ ] License Compliance</p> </li> <li>Scan <code>requirements.txt</code> and <code>Cargo.toml</code> for incompatible licenses.</li> </ul>"},{"location":"roadmap/#phase-11-auto-remediation-done","title":"Phase 11: Auto-Remediation \u2705 DONE","text":"<p>Safe, automated code fixes.</p> <ul> <li>[x] Safe Code Removal (<code>--fix</code>)</li> <li>Implementation: Use AST byte ranges from <code>ruff_python_parser</code> for precise removal.</li> <li>Features:<ul> <li><code>--fix</code> flag removes unused functions, classes, and imports</li> <li><code>--dry-run</code> previews changes without applying</li> <li>CST mode (tree-sitter) is now enabled by default for better comment preservation</li> <li>Only high-confidence items (\u226590%) are auto-fixed</li> <li>Cascading detection: methods inside unused classes are auto-removed with their parent class</li> </ul> </li> </ul>"},{"location":"roadmap/#phase-12-security-lifecycle","title":"Phase 12: Security &amp; Lifecycle","text":"<ul> <li>[ ] Fuzzing Environment Stabilization</li> <li>Fuzzing is currently difficult on Windows due to MSVC toolchain and sanitizer runtime issues.</li> <li>Solution: Transition fuzzing CI to a purely Linux-based environment (or WSL).</li> <li>This allows reliable <code>cargo fuzz</code> execution to catch edge-case crashes and undefined behavior.</li> <li>Implementation: Add a <code>fuzz-linux.yml</code> workflow that runs in Ubuntu and uses <code>cargo +nightly fuzz</code>.</li> </ul>"},{"location":"roadmap/#phase-13-interprocedural-taint-analysis","title":"Phase 13: Interprocedural Taint Analysis","text":"<p>Deep data-flow analysis across function boundaries.</p> <ul> <li>[ ] Global Call Graph Construction \ud83d\udd04 IN PROGRESS</li> <li>Map function calls across the entire project to track how data moves between modules.</li> <li>Necessary for tracking \"taint\" from a source in one file to a sink in another.</li> <li>[ ] Cross-Function Taint Tracking</li> <li>Store and propagate \"taint state\" for function arguments and return values.</li> <li>Goal: Catch vulnerabilities like an API request being passed through a helper function into an <code>eval()</code> or SQL query.</li> <li>[ ] Sanitization Recognition</li> <li>Detect when tainted data passes through \"safe\" functions (like <code>html.escape()</code> or custom sanitizers).</li> <li>Benefit: Significantly reduces False Positives by knowing when data is no longer dangerous.</li> <li>[ ] Framework-Specific Entry Points</li> <li>Add deep support for FastAPI dependencies, Django middleware, and Flask request hooks.</li> <li>Benefit: Provides \"Premium\" level security coverage for modern Python web applications.</li> </ul> <p>135 total ground truth items, 11 tools benchmarked</p>"},{"location":"security/","title":"Security Analysis","text":"<p>CytoScnPy includes a powerful security engine powered by Rust. It performs Secret Scanning, Dangerous Pattern Matching, and Taint Analysis.</p>"},{"location":"security/#running-security-scans","title":"Running Security Scans","text":"<p>To enable security checks, use the <code>--secrets</code> and <code>--danger</code> flags:</p> <pre><code>cytoscnpy . --secrets --danger\n</code></pre>"},{"location":"security/#secret-scanning-secrets","title":"Secret Scanning (<code>--secrets</code>)","text":"<p>Detects hardcoded secrets, API keys, and credentials using a combination of regex patterns and Shannon Entropy analysis.</p> <ul> <li>AWS Keys: Access IDs, Secret Keys.</li> <li>API Tokens: Stripe, Slack, PyPI, GitHub, etc.</li> <li>Private Keys: RSA, DSA, EC private keys.</li> <li>High Entropy Strings: Random strings that look like secrets but don't match specific patterns.</li> </ul>"},{"location":"security/#dangerous-code-danger","title":"Dangerous Code (<code>--danger</code>)","text":"<p>Detects patterns known to cause vulnerabilities.</p> <p>For a complete list of all rules organized by category, see: Dangerous Code Rules</p>"},{"location":"security/#rule-categories","title":"Rule Categories","text":"<ul> <li>Code Execution &amp; Unsafe Calls (CSP-D0xx)</li> <li>Injection &amp; Logic Attacks (CSP-D1xx)</li> <li>Deserialization (CSP-D2xx)</li> <li>Cryptography &amp; Randomness (CSP-D3xx)</li> <li>Network &amp; HTTP Security (CSP-D4xx)</li> <li>File Operations &amp; Path Traversal (CSP-D5xx)</li> <li>Modern Python &amp; Frameworks (CSP-D9xx)</li> </ul>"},{"location":"security/#taint-analysis","title":"Taint Analysis","text":"<p>CytoScnPy goes beyond simple pattern matching by tracking data flow.</p> <ul> <li>Sources: User inputs (Flask <code>request</code>, Django <code>request</code>, CLI args, Environment variables).</li> <li>Sinks: Dangerous functions (SQL execute, eval, os.system).</li> <li>Sanitizers: Functions that clean data (e.g., <code>int()</code>, <code>escape()</code>).</li> </ul> <p>If data flows from a Source to a Sink without passing through a Sanitizer, it is flagged as a vulnerability.</p>"},{"location":"security/#supported-analysis-levels","title":"Supported Analysis Levels","text":"Level Description Implementation Intraprocedural Checks flows within single functions. Fast, catches local bugs Interprocedural Checks flows across functions in the same file. Tracks cross-function data flow Cross-file Checks flows across module boundaries. Deep analysis (highest precision) <p>CytoScnPy uses a multi-layered approach to track taint across your entire project, identifying vulnerabilities where untrusted input reaches critical system sinks.</p>"},{"location":"usage/","title":"User Guide","text":"<p>This guide covers everything you need to know to use CytoScnPy effectively.</p>"},{"location":"usage/#quick-start","title":"\ud83d\ude80 Quick Start","text":"<p>Run analysis on your current directory:</p> <pre><code>cytoscnpy . --secrets --danger --quality\n</code></pre>"},{"location":"usage/#features-usage","title":"Features &amp; Usage","text":""},{"location":"usage/#dead-code-detection","title":"\ud83d\udc80 Dead Code Detection","text":"<p>CytoScnPy statically analyzes your code to find unused symbols. It detects:</p> <ul> <li>Functions &amp; Classes: Definitions that are never called.</li> <li>Methods: Cascading detection (if a class is unused, its methods are too).</li> <li>Imports: Unused import statements.</li> <li>Variables: Local variables assigned but never read.</li> </ul>"},{"location":"usage/#installation","title":"\ud83d\udce6 Installation","text":"<p>Linux / macOS:</p> <pre><code># Install\ncurl -fsSL https://raw.githubusercontent.com/djinn09/CytoScnPy/main/install.sh | bash\n</code></pre> <p>Windows (PowerShell):</p> <pre><code># Install\nirm https://raw.githubusercontent.com/djinn09/CytoScnPy/main/install.ps1 | iex\n</code></pre> <p>Framework Support: Automatically detects usage in Flask routes, Django views, FastAPI endpoints, and Pydantic models.</p>"},{"location":"usage/#security-analysis","title":"\ud83d\udd12 Security Analysis","text":"<p>Enable with <code>--secrets</code> and <code>--danger</code>.</p> <p>Secret Scanning: Finds hardcoded secrets (API keys, tokens) using regex and entropy analysis. Dangerous Code: Detects patterns known to cause vulnerabilities (SQLi, XSS, RCE, etc.).</p> <p>For detailed vulnerability rules (<code>CSP-Dxxx</code>), see the Dangerous Code Rules Index or the general Security Analysis overview.</p>"},{"location":"usage/#code-quality-metrics","title":"\ud83d\udcca Code Quality Metrics","text":"<p>Enable with <code>--quality</code>.</p> <ul> <li>Cyclomatic Complexity (CC): Measures code branching.</li> <li>Maintainability Index (MI): 0-100 score (higher is better).</li> <li>Halstead Metrics: Algorithmic complexity.</li> </ul> <p>For a full list of quality rules and their standard IDs (B006, E722, etc.), see the Code Quality Rules reference.</p>"},{"location":"usage/#clone-detection","title":"\ud83e\udde9 Clone Detection","text":"<p>Finds duplicate or near-duplicate code blocks (Type-1, Type-2, and Type-3 clones).</p> <pre><code>cytoscnpy . --clones --clone-similarity 0.8\n</code></pre> <ul> <li>Type-1: Exact copies (identical code).</li> <li>Type-2: Syntactically identical (variable renaming).</li> <li>Type-3: Near-miss clones (small edits/additions).</li> </ul> <p>Options:</p> <ul> <li><code>--clone-similarity &lt;0.0-1.0&gt;</code>: Minimum similarity threshold. Default is <code>0.8</code> (80% similarity). Lower values find more matches but may increase false positives.</li> </ul> <p>Performance: Clone detection is computationally intensive for very large codebases.</p>"},{"location":"usage/#auto-fix","title":"\ud83d\udee0\ufe0f Auto-Fix","text":"<p>Remove dead code automatically.</p> <ol> <li>Preview: <code>cytoscnpy . --fix</code></li> <li>Apply: <code>cytoscnpy . --fix --apply</code></li> </ol>"},{"location":"usage/#html-reports","title":"\ud83d\udcc4 HTML Reports","text":"<p>Generate interactive, self-contained HTML reports for easier navigation of findings.</p> <pre><code>cytoscnpy . --html --secrets --danger\n</code></pre> <p>(Note: <code>--html</code> automatically enables <code>--quality</code> but strictly security scans need explicit flags).</p> <p>Features:</p> <ul> <li>Dashboard: High-level summary of issues.</li> <li>Search: Interactive search across all findings.</li> <li>Filtering: Filter by severity, category, or file.</li> <li>Source View: Clickable file links with line numbers.</li> </ul> <p>When to use HTML vs JSON:</p> <ul> <li>Use HTML for human review and team sharing.</li> <li>Use JSON (<code>--json</code>) for CI/CD pipelines and automated processing.</li> </ul>"},{"location":"usage/#pre-commit-hooks","title":"\u2693 Pre-commit Hooks","text":"<p>Automate your analysis on every commit. See the Pre-commit Guide for installation and configuration.</p>"},{"location":"usage/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>CytoScnPy supports configuration via:</p> <ol> <li><code>.cytoscnpy.toml</code> (Project root)</li> <li><code>pyproject.toml</code> (Scanning under <code>[tool.cytoscnpy]</code>)</li> </ol>"},{"location":"usage/#option-1-cytoscnpytoml","title":"Option 1: <code>.cytoscnpy.toml</code>","text":"<pre><code>[cytoscnpy]\nconfidence = 60\nexclude_folders = [\"venv\", \"build\", \"dist\"]\nsecrets = true\ndanger = true\nquality = true\ninclude_ipynb = false\n\n# CI/CD Gates (Fail if exceeded)\nfail_threshold = 5.0   # &gt;5% unused code\nmax_complexity = 15    # Function CC &gt; 15\nmin_mi = 40.0         # MI &lt; 40\n</code></pre>"},{"location":"usage/#option-2-pyprojecttoml","title":"Option 2: <code>pyproject.toml</code>","text":"<pre><code>[tool.cytoscnpy]\nconfidence = 60\nexclude_folders = [\"venv\", \"build\", \"dist\"]\nsecrets = true\ndanger = true\nquality = true\n\n# CI/CD Gates\nfail_threshold = 5.0\nmax_complexity = 15\nmin_mi = 40.0\n</code></pre>"},{"location":"usage/#cli-reference","title":"\ud83d\udcd6 CLI Reference","text":"<p>For a complete reference, see docs/CLI.md.</p> <pre><code>cytoscnpy [PATHS]... [OPTIONS]\n</code></pre>"},{"location":"usage/#core-options","title":"Core Options","text":"Flag Description <code>--root &lt;PATH&gt;</code> Project root for analysis (CI/CD mode). <code>--confidence &lt;N&gt;</code> Minimum confidence threshold (0-100). Default: 60. <code>--secrets</code> (<code>-s</code>) Scan for API keys, tokens, credentials. <code>--danger</code> (<code>-d</code>) Scan for dangerous code + taint analysis. <code>--quality</code> (<code>-q</code>) Scan for code quality issues. <code>--clones</code> Enable code clone detection. <code>--no-dead</code> (<code>-n</code>) Skip dead code detection."},{"location":"usage/#output-formatting","title":"Output Formatting","text":"Flag Description <code>--json</code> Output detection results as JSON. <code>--html</code> Generate interactive HTML report. <code>--quiet</code> Summary only, no detailed tables. <code>--verbose</code> (<code>-v</code>) Debug output."},{"location":"usage/#filtering","title":"Filtering","text":"Flag Description <code>--exclude-folder &lt;DIR&gt;</code> Exclude specific folders. <code>--include-folder &lt;DIR&gt;</code> Force include folders. <code>--include-tests</code> Include test files in analysis. <code>--include-ipynb</code> Include Jupyter notebooks."},{"location":"usage/#cicd-quality-gates","title":"CI/CD Quality Gates","text":"<p>CytoScnPy can enforce quality standards by exiting with code <code>1</code>:</p> Flag Description <code>--fail-threshold &lt;N&gt;</code> Fail if unused code % &gt; N. <code>--max-complexity &lt;N&gt;</code> Fail if any function complexity &gt; N. <code>--min-mi &lt;N&gt;</code> Fail if Maintainability Index &lt; N. <code>--fail-on-quality</code> Fail on any quality issue."},{"location":"usage/#subcommands","title":"Subcommands","text":"<p>CytoScnPy has specialized subcommands for specific metrics.</p>"},{"location":"usage/#hal-halstead-metrics","title":"<code>hal</code> - Halstead Metrics","text":"<pre><code>cytoscnpy hal . --functions\n</code></pre> <p>Calculates Halstead complexity metrics.</p> <ul> <li><code>--functions</code>: Compute at function level.</li> </ul>"},{"location":"usage/#files-per-file-metrics","title":"<code>files</code> - Per-File Metrics","text":"<pre><code>cytoscnpy files . --json\n</code></pre> <p>Shows detailed metrics table for each file.</p>"},{"location":"usage/#cc-cyclomatic-complexity","title":"<code>cc</code> - Cyclomatic Complexity","text":"<pre><code>cytoscnpy cc . --min-rank C --show-complexity\n</code></pre> <p>Calculates McCabe complexity.</p> <ul> <li><code>--show-complexity</code>: Show score.</li> <li><code>--min-rank &lt;A-F&gt;</code>: Filter by rank (A=Simple ... F=Critical).</li> <li><code>--max-complexity &lt;N&gt;</code>: Fail if complexity &gt; N.</li> </ul>"},{"location":"usage/#mi-maintainability-index","title":"<code>mi</code> - Maintainability Index","text":"<pre><code>cytoscnpy mi . --show --average\n</code></pre> <p>Calculates Maintainability Index (0-100).</p> <ul> <li><code>--show</code>: Show values.</li> <li><code>--fail-threshold &lt;N&gt;</code>: Fail if MI &lt; N.</li> </ul>"},{"location":"usage/#additional-quality-options","title":"Additional Quality Options","text":"Flag Description <code>--max-nesting &lt;N&gt;</code> Fail if nesting depth &gt; N. <code>--max-args &lt;N&gt;</code> Fail if function arguments &gt; N. <code>--max-lines &lt;N&gt;</code> Fail if function lines &gt; N. <code>--ipynb-cells</code> Report findings at cell level for notebooks."},{"location":"usage/#raw-raw-metrics","title":"<code>raw</code> - Raw Metrics","text":"<pre><code>cytoscnpy raw . --json\n</code></pre> <p>Calculates LOC, SLOC, Comments, Blank lines.</p>"},{"location":"usage/#stats-project-statistics","title":"<code>stats</code> - Project Statistics","text":"<pre><code>cytoscnpy stats . --all\n</code></pre> <p>Runs full analysis (secrets, danger, quality) and prints summary statistics.</p> <p>Options:</p> <ul> <li><code>--all</code> (<code>-a</code>): Enable all scanners (secrets, danger, quality).</li> <li><code>--secrets</code> (<code>-s</code>): Enable secret scanning.</li> <li><code>--danger</code> (<code>-d</code>): Enable danger/taint analysis.</li> <li><code>--quality</code> (<code>-q</code>): Enable quality analysis.</li> <li><code>--exclude-folder &lt;DIR&gt;</code>: Exclude specific folders from stats analysis.</li> <li><code>--json</code>: Output as JSON.</li> <li><code>--output &lt;FILE&gt;</code> (<code>-o</code>): Save report to file.</li> </ul>"},{"location":"usage/#mcp-server-mcp-integration","title":"<code>mcp-server</code> - MCP Integration","text":"<pre><code>cytoscnpy mcp-server\n</code></pre> <p>Starts the Model Context Protocol (MCP) server for integration with AI assistants (Claude Desktop, Cursor, GitHub Copilot).</p>"},{"location":"usage/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":""},{"location":"usage/#common-issues","title":"Common Issues","text":"<p>1. \"Too many open files\" error</p> <ul> <li>Limit parallelization or exclude large directories (<code>node_modules</code>, <code>.git</code>).</li> </ul> <p>2. False Positives</p> <ul> <li>Use inline comments to suppress findings on a specific line:</li> </ul> Comment Effect <code># pragma: no cytoscnpy</code> Legacy format (suppresses all CytoScnPy findings) <code># noqa</code> Bare noqa (suppresses all CytoScnPy findings) <code># ignore</code> Bare ignore (suppresses all CytoScnPy findings) <code># noqa</code> (for Quality) Use bare <code># noqa</code> for quality rules for now <code># noqa: CSP-Dxxx</code> Specific (suppresses only a specific Danger rule) <p>Examples:</p> <pre><code>def mutable_default(arg=[]):  # noqa\n    pass\n\nx = [1, 2] == None # noqa -- suppress dangerous comparison\ny = api_key  # pragma: no cytoscnpy\n</code></pre> <ul> <li>For bulk ignores, use the <code>.cytoscnpy.toml</code> configuration file's ignore list.</li> </ul> <p>3. Performance is slow</p> <ul> <li>Check if large files or build artifacts are being scanned. Use <code>--exclude-folder</code>.</li> <li>Clone detection is slower than standard analysis.</li> </ul> <p>4. \"Missing integrity\" finding</p> <ul> <li>Security check requires SRI hashes for external scripts. Add <code>integrity=\"...\"</code> to your HTML.</li> </ul>"},{"location":"usage/#links","title":"Links","text":"<ul> <li>PyPI: pypi.org/project/cytoscnpy</li> <li>VS Code Extension: Visual Studio Marketplace</li> <li>GitHub Repository: github.com/djinn09/CytoScnPy</li> </ul>"},{"location":"blog/","title":"Blog","text":"<p>Welcome to the CytoScnPy blog. Here we share updates, release notes, and static analysis tips.</p>"},{"location":"blog/2025/12/28/welcome-to-cytoscnpy/","title":"Welcome to CytoScnPy","text":"<p>We are excited to launch our new documentation site and blog!</p> <p>CytoScnPy is growing fast, and we want to keep you updated on all the latest performance improvements and security features.</p> <p>Stay tuned for more updates!</p>"},{"location":"danger/best-practices/","title":"Category 7: Best Practices (CSP-D7xx)","text":"<p>Rules in this category detect violations of Python best practices that often lead to security issues or regressions in production.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D701 <code>assert</code> used in production code LOW Asserts are removed in optimized mode (<code>-O</code>) Use explicit <code>if ...: raise</code> CSP-D702 Insecure Imports (<code>telnetlib</code>, <code>ftplib</code>, etc) HIGH / LOW Use of deprecated/insecure libraries Use modern replacements (<code>requests</code>, <code>ssh</code>) CSP-D703 <code>Jinja2 Environment(autoescape=False)</code> HIGH Risk of XSS if content is not escaped Set <code>autoescape=True</code> CSP-D704 Blacklisted function calls (e.g., <code>pdb.set_trace</code>) LOW / MED Debugging leftovers in production Remove debug code"},{"location":"danger/best-practices/#in-depth-asserts-in-production-csp-d701","title":"In-depth: Asserts in Production (CSP-D701)","text":"<p>The <code>assert</code> statement is intended for internal self-checks during development. Python's bytecode compiler removes all assert statements when compiling with optimization enabled (<code>python -O</code>). Relying on assert for security logic (e.g., <code>assert user.is_admin</code>) leads to bypasses in production.</p>"},{"location":"danger/best-practices/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>def delete_user(user):\n    assert user.is_admin, \"Not allowed\"\n    # ... delete logic ...\n</code></pre>"},{"location":"danger/best-practices/#safe-alternative","title":"Safe Alternative","text":"<pre><code>def delete_user(user):\n    if not user.is_admin:\n        raise PermissionError(\"Not allowed\")\n    # ... delete logic ...\n</code></pre>"},{"location":"danger/best-practices/#in-depth-insecure-imports-csp-d702","title":"In-depth: Insecure Imports (CSP-D702)","text":"<p>Certain standard library modules are considered insecure or obsolete.</p> <ul> <li><code>telnetlib</code>: Telnet transmits data in cleartext. Use SSH (e.g., <code>paramiko</code> or <code>fabric</code>).</li> <li><code>ftplib</code>: FTP transmits credentials in cleartext. Use SFTP or FTPS.</li> <li><code>xml.etree</code>, <code>xml.sax</code>: Vulnerable to XXE (XML External Entity) attacks. Use <code>defusedxml</code>.</li> <li><code>pickle</code>, <code>marshal</code>: Insecure deserialization. Use <code>json</code> or <code>hmac</code> signatures.</li> </ul>"},{"location":"danger/best-practices/#dangerous-pattern_1","title":"Dangerous Pattern","text":"<pre><code>import telnetlib\ntn = telnetlib.Telnet(\"host\") # VULNERABLE: Cleartext traffic\n</code></pre>"},{"location":"danger/best-practices/#safe-alternative_1","title":"Safe Alternative","text":"<pre><code># Use a library that supports SSH/SCP/SFTP\nimport paramiko\nclient = paramiko.SSHClient()\n# ...\n</code></pre>"},{"location":"danger/code-execution/","title":"Category 1: Code Execution &amp; Unsafe calls (CSP-D0xx)","text":"<p>Rules in this category detect patterns that can lead to arbitrary code execution or command injection. These are the highest-risk findings.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D001 <code>eval(...)</code> HIGH Arbitrary code execution Use <code>ast.literal_eval</code> or a dedicated parser CSP-D002 <code>exec(...)</code> HIGH Arbitrary code execution Remove or use explicit dispatch CSP-D003 <code>os.system(...)</code>, <code>subprocess.*(shell=True)</code> CRITICAL Command injection <code>subprocess.run([cmd, ...])</code>; strict allowlist CSP-D004 <code>asyncio.create_subprocess_shell(...)</code> CRITICAL Async command injection Use <code>create_subprocess_exec</code> with list args CSP-D005 <code>input(...)</code> HIGH Unsafe in Py2 (acts like eval) Use <code>raw_input()</code> (Py2) or validate in Py3"},{"location":"danger/code-execution/#in-depth-async-legacy-shell-injection-csp-d004","title":"In-depth: Async &amp; Legacy Shell Injection (CSP-D004)","text":"<p>Traditional shell execution functions and modern async variants are equally dangerous when given untrusted input.</p>"},{"location":"danger/code-execution/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>import asyncio\nimport os\n\n# Async shell injection\nawait asyncio.create_subprocess_shell(f\"ls {user_input}\")\n\n# Legacy popen injection (This is actually usually CSP-D003 or CSP-D004 depending on rule logic, D004 for async/legacy separation if applicable)\n# Wait, META_SUBPROCESS checks popen too. But META_ASYNC_SUBPROCESS checks async.\n# I will keep the example but update the ID.\n</code></pre>"},{"location":"danger/code-execution/#safe-alternative","title":"Safe Alternative","text":"<pre><code>import asyncio\nimport os\n\n# Async shell injection\nawait asyncio.create_subprocess_shell(f\"ls {user_input}\")\n\n# Legacy popen injection\nos.popen(f\"cat {user_input}\")\n</code></pre>"},{"location":"danger/code-execution/#safe-alternative_1","title":"Safe Alternative","text":"<pre><code>import asyncio\nimport subprocess\n\n# Safe async execution\nawait asyncio.create_subprocess_exec(\"ls\", user_input)\n\n# Safe synchronous execution\nsubprocess.run([\"cat\", user_input])\n</code></pre>"},{"location":"danger/code-execution/#in-depth-command-injection-csp-d003","title":"In-depth: Command Injection (CSP-D003)","text":"<p>Command injection occurs when an application executes a shell command but does not properly validate or sanitize the arguments.</p>"},{"location":"danger/code-execution/#dangerous-pattern_1","title":"Dangerous Pattern","text":"<pre><code>import subprocess\nuser_input = \"ls; rm -rf /\"\nsubprocess.run(f\"ls {user_input}\", shell=True)\n</code></pre>"},{"location":"danger/code-execution/#safe-alternative_2","title":"Safe Alternative","text":"<pre><code>import subprocess\nuser_input = \"filename.txt\"\nsubprocess.run([\"ls\", user_input]) # shell=False is default and safer\n</code></pre>"},{"location":"danger/cryptography/","title":"Category 4: Cryptography &amp; Randomness (CSP-D3xx)","text":"<p>Rules in this category detect weak cryptographic algorithms and insecure random number generation.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D301 Weak hashing (MD5, etc.) MEDIUM Collision-prone weak hash Use SHA-256 or SHA-3 CSP-D302 Weak hashing (SHA-1) MEDIUM Collision-prone weak hash Use SHA-256 or SHA-3 CSP-D304 Insecure ciphers (DES, ARC4, etc.) HIGH Process/Data compromise Use AES CSP-D305 Insecure cipher modes (ECB) MEDIUM Pattern leakage in cipher Use CBC or GCM CSP-D311 <code>random.*</code> (Standard PRNG) LOW Predictable for crypto use Use <code>secrets</code> or <code>os.urandom</code>"},{"location":"danger/cryptography/#in-depth-weak-hashing-csp-d301","title":"In-depth: Weak Hashing (CSP-D301)","text":"<p>MD5 and SHA-1 are considered cryptographically broken and should not be used for security-sensitive purposes like password hashing or digital signatures.</p>"},{"location":"danger/cryptography/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>import hashlib\nh = hashlib.md5(b\"password\").hexdigest() # INSECURE\n</code></pre>"},{"location":"danger/cryptography/#safe-alternative","title":"Safe Alternative","text":"<pre><code>import hashlib\nh = hashlib.sha256(b\"password\").hexdigest() # SECURE\n</code></pre>"},{"location":"danger/deserialization/","title":"Category 3: Deserialization (CSP-D2xx)","text":"<p>Rules in this category detect unsafe deserialization of untrusted data, which can lead to Remote Code Execution (RCE).</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D201 <code>pickle</code>, <code>dill</code>, <code>shelve</code>, <code>jsonpickle</code>, <code>pandas.read_pickle</code> CRITICAL Arbitrary code execution Use JSON, msgpack, or signed data CSP-D202 <code>yaml.load</code> (no SafeLoader) HIGH Arbitrary code execution <code>yaml.safe_load(...)</code> CSP-D203 <code>marshal.load</code>/<code>loads</code> MEDIUM Arbitrary code execution Use JSON or signed data CSP-D204 <code>torch.load</code>, <code>keras.load_model</code>, <code>joblib.load</code> CRITICAL ACE via embedded pickle Use <code>weights_only=True</code> (torch)"},{"location":"danger/deserialization/#in-depth-ml-model-deserialization-csp-d204","title":"In-depth: ML Model Deserialization (CSP-D204)","text":"<p>Many ML libraries use <code>pickle</code> under the hood to load models. Loading a model from an untrusted source can execute arbitrary code on your machine.</p>"},{"location":"danger/deserialization/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>import torch\nmodel = torch.load(\"untrusted_model.pt\") # VULNERABLE\n</code></pre>"},{"location":"danger/deserialization/#safe-alternative","title":"Safe Alternative","text":"<pre><code>import torch\nmodel = torch.load(\"untrusted_model.pt\", weights_only=True) # SAFE: Only loads tensors\n</code></pre>"},{"location":"danger/deserialization/#in-depthmarshal-deserialization-csp-d203","title":"In-depth:marshal Deserialization (CSP-D203)","text":"<p>The <code>marshal</code> module is intended for internal Python use and is not secure against malicious data. It can be used to execute arbitrary code.</p>"},{"location":"danger/deserialization/#dangerous-pattern_1","title":"Dangerous Pattern","text":"<pre><code>import marshal\ndata = get_data_from_network()\nobj = marshal.loads(data) # DANGEROUS\n</code></pre>"},{"location":"danger/deserialization/#in-depth-pickle-deserialization-csp-d201","title":"In-depth: Pickle Deserialization (CSP-D201)","text":"<p>The <code>pickle</code> module is NOT secure against erroneous or maliciously constructed data. Never unpickle data received from an untrusted or unauthenticated source.</p>"},{"location":"danger/deserialization/#dangerous-pattern_2","title":"Dangerous Pattern","text":"<pre><code>import pickle\ndata = get_data_from_network()\nobj = pickle.loads(data) # EXTREMELY DANGEROUS\n</code></pre>"},{"location":"danger/deserialization/#safe-alternative_1","title":"Safe Alternative","text":"<pre><code>import json\ndata = get_data_from_network()\nobj = json.loads(data) # SAFE\n</code></pre>"},{"location":"danger/filesystem/","title":"Category 6: File Operations &amp; Temporary Data (CSP-D5xx)","text":"<p>Rules in this category detect path traversal vulnerabilities, insecure archive extraction, and bad file permissions.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D501 Dynamic path in <code>open</code>/<code>os.path</code> HIGH Path traversal Use <code>Path.resolve</code>, check base dir CSP-D502 <code>tarfile.extractall</code> without filter HIGH Path traversal / Zip Slip Use <code>filter='data'</code> (Py 3.12+) CSP-D503 <code>zipfile.ZipFile.extractall</code> HIGH Path traversal / Zip Slip Validate member filenames CSP-D504 <code>tempfile.mktemp</code> HIGH Race condition (TOCTOU) Use <code>tempfile.mkstemp</code> CSP-D505 <code>os.chmod</code> with <code>stat.S_IWOTH</code> HIGH World-writable file Use stricter permissions (0o600) CSP-D506 <code>os.tempnam</code>/<code>tmpnam</code> MEDIUM Symlink attacks Use <code>tempfile</code> module"},{"location":"danger/filesystem/#in-depth-path-traversal-csp-d501","title":"In-depth: Path Traversal (CSP-D501)","text":"<p>Path traversal allows an attacker to access files outside the intended directory.</p>"},{"location":"danger/filesystem/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>filename = request.args.get(\"file\")\nwith open(f\"uploads/{filename}\", \"rb\") as f: # VULNERABLE to ../../etc/passwd\n    data = f.read()\n</code></pre>"},{"location":"danger/filesystem/#safe-alternative","title":"Safe Alternative","text":"<pre><code>import os\nfilename = request.args.get(\"file\")\nbase_dir = os.path.abspath(\"uploads\")\nfull_path = os.path.abspath(os.path.join(base_dir, filename))\nif full_path.startswith(base_dir):\n    with open(full_path, \"rb\") as f: # SAFE: Boundary checked\n        data = f.read()\n</code></pre>"},{"location":"danger/injection/","title":"Category 2: Injection &amp; Logic Attacks (CSP-D1xx)","text":"<p>Rules in this category detect SQL injection, Cross-Site Scripting (XSS), and insecure XML processing.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D101 <code>cursor.execute</code> (f-string/concat) CRITICAL SQL injection (cursor) Use parameterized queries (<code>?</code>, <code>%s</code>) CSP-D102 <code>sqlalchemy.text</code>, <code>read_sql</code> (dynamic) CRITICAL SQL injection (raw) Use bound parameters / ORM builders CSP-D103 Flask/Jinja dynamic templates CRITICAL XSS (Cross-site scripting) Use static templates; escape content CSP-D104 <code>xml.etree</code>, <code>minidom</code>, <code>sax</code>, <code>lxml</code> HIGH / MED XXE / DoS Use <code>defusedxml</code> CSP-D105 <code>django.utils.safestring.mark_safe</code> MEDIUM XSS bypass Avoid unless content is strictly trusted"},{"location":"danger/injection/#in-depth-sql-injection-csp-d101","title":"In-depth: SQL Injection (CSP-D101)","text":"<p>SQL injection occurs when user input is directly concatenated into a SQL string.</p>"},{"location":"danger/injection/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>query = f\"SELECT * FROM users WHERE username = '{user_input}'\"\ncursor.execute(query) # VULNERABLE\n</code></pre>"},{"location":"danger/injection/#safe-alternative","title":"Safe Alternative","text":"<pre><code>query = \"SELECT * FROM users WHERE username = %s\"\ncursor.execute(query, (user_input,)) # SAFE: Parameterized\n</code></pre>"},{"location":"danger/modern-python/","title":"Category 9: Information Privacy &amp; Frameworks (CSP-D9xx)","text":"<p>This category covers security rules for sensitive data handling, information leakage, and specific web framework misconfigurations (e.g., Django, Flask).</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D901 Logging sensitive variables MEDIUM Data leakage in logs Redact passwords, tokens, API keys CSP-D902 Hardcoded <code>SECRET_KEY</code> CRITICAL Key exposure in Django Store in environment variables"},{"location":"danger/modern-python/#in-depth-logging-sensitive-data-csp-d901","title":"In-depth: Logging Sensitive Data (CSP-D901)","text":"<p>Logging sensitive information like API keys or user passwords can lead to data breaches if logs are compromised.</p>"},{"location":"danger/modern-python/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>import logging\napi_key = \"sk-...\"\nlogging.info(f\"Using API key: {api_key}\") # DANGEROUS: Leaks in logs\n</code></pre>"},{"location":"danger/modern-python/#safe-alternative","title":"Safe Alternative","text":"<pre><code>import logging\napi_key = \"sk-...\"\nlogging.info(\"Using API key: [REDACTED]\") # SAFE\n</code></pre>"},{"location":"danger/modern-python/#in-depth-framework-secrets-csp-d902","title":"In-depth: Framework Secrets (CSP-D902)","text":"<p>Framework settings files often contain sensitive keys that must not be committed to source control. Hardcoded secrets are easily discovered by attackers.</p>"},{"location":"danger/modern-python/#dangerous-pattern-django","title":"Dangerous Pattern (Django)","text":"<pre><code># settings.py\nSECRET_KEY = 'django-insecure-hardcoded-key-here' # VULNERABLE\n</code></pre>"},{"location":"danger/modern-python/#safe-alternative_1","title":"Safe Alternative","text":"<pre><code>import os\nSECRET_KEY = os.environ.get('DJANGO_SECRET_KEY') # SAFE: Loaded from env\n</code></pre>"},{"location":"danger/network/","title":"Category 5: Network &amp; HTTP (CSP-D4xx)","text":"<p>Rules in this category detect insecure network configurations, SSRF vulnerabilities, and missing timeouts.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D401 <code>requests.*(verify=False)</code> HIGH MITM attacks Keep <code>verify=True</code> CSP-D402 Unvalidated URLs in network calls CRITICAL SSRF (Request forgery) Allowlist domains; validate host/port CSP-D403 <code>app.run(debug=True)</code> HIGH Possible RCE in production Set <code>debug=False</code> CSP-D404 Hardcoded bind to <code>0.0.0.0</code> or <code>::</code> MEDIUM Exposes service to external Bind to <code>127.0.0.1</code> locally CSP-D405 Request without timeout MEDIUM Thread/Process exhaustion Set <code>timeout=5.0</code> (or similar) CSP-D406 <code>ftplib.*</code> MEDIUM Cleartext FTP traffic Use SFTP or FTPS CSP-D407 <code>HTTPSConnection</code> without context MEDIUM MITM on legacy Python Provide a secure SSL context CSP-D408 <code>ssl._create_unverified_context</code> MEDIUM Bypasses SSL verification Use default secure context CSP-D409 <code>telnetlib.*</code> MEDIUM Cleartext Telnet traffic Use SSH (<code>paramiko</code>) CSP-D410 <code>urllib.urlopen</code> (audit schemes) MEDIUM <code>file://</code> scheme exploits Validate/restrict schemes CSP-D411 <code>ssl.wrap_socket</code> (deprecated) MEDIUM Often insecure/deprecated Use <code>SSLContext.wrap_socket</code>"},{"location":"danger/network/#in-depth-ssrf-csp-d402","title":"In-depth: SSRF (CSP-D402)","text":"<p>Server-Side Request Forgery (SSRF) allows an attacker to make the server perform requests to internal or external resources.</p>"},{"location":"danger/network/#dangerous-pattern","title":"Dangerous Pattern","text":"<pre><code>import requests\nurl = request.args.get(\"url\")\nrequests.get(url) # VULNERABLE to SSRF\n</code></pre>"},{"location":"danger/network/#safe-alternative","title":"Safe Alternative","text":"<pre><code>VALID_DOMAINS = [\"api.example.com\"]\nurl = request.args.get(\"url\")\nif get_domain(url) in VALID_DOMAINS:\n    requests.get(url) # SAFE: Validated\n</code></pre>"},{"location":"danger/type-safety/","title":"Category 7: Type Safety &amp; Validation (CSP-D6xx)","text":"<p>Rules in this category detect method calls on objects whose types suggest a mismatch between expected and actual usage, or general type-related safety issues.</p> Rule ID Pattern Severity Why it's risky Safer alternative / Fix CSP-D601 Type-based method misuse HIGH Logic errors / Type confusion Use static typing and validation"},{"location":"danger/type-safety/#in-depth-method-misuse-csp-d601","title":"In-depth: Method Misuse (CSP-D601)","text":"<p>CytoScnPy performs light-weight type inference to detect when methods are called on object types that don't support them, or when framework-specific methods are used in an unsafe context.</p>"},{"location":"danger/type-safety/#example","title":"Example","text":"<p>Calling a list-specific method like <code>append</code> on what appears to be a <code>dict</code> or a <code>None</code> value can lead to runtime crashes.</p> <pre><code>def process_data(items):\n    # If items can be None or a dict, this will crash\n    items.append(42)\n</code></pre>"},{"location":"danger/type-safety/#recommendation","title":"Recommendation","text":"<p>Use <code>isinstance()</code> checks or Python type hints (<code>List[int]</code>) to ensure type safety.</p>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/category/announcements/","title":"Announcements","text":""}]}